@model IEnumerable<F_Result.Models.UsRoleViewModel>
@{
    ViewBag.Title = "Пользователи";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .gridtable > tbody > tr > th {
        text-align: center;
    }

    .gridtable > tbody > tr:first-child {
        background-color: #eee;
    }

    #clearfilter:hover, #applyfilter:hover {
        color: #d9534f;
    }

    #clearfilter, #applyfilter {
        cursor: pointer;
    }
</style>

<div id="loadingImg">
    <div id="preloadImg">
        <img src="~/Content/Images/loader.gif" />
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">
                @ViewBag.Title
                <small>Список пользователей</small>
            </h1>
            <ol class="breadcrumb">
                <li>
                    @Html.ActionLink("Главная", "Index", "Home", new { Area = "" }, null)
                </li>
                <li>
                    Управление
                </li>
                <li class="active">Пользователи</li>
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <p class="text-success" id="resultOk"> @TempData["MessageOk"]</p>
            <p class="text-danger" id="resultError"> @TempData["MessageError"]</p>
        </div>
    </div>

    <div class="form-inline" style="margin-bottom:10px;">
        @using (Ajax.BeginForm("ShowUsersPartial", "UsersManagement", new AjaxOptions { UpdateTargetId = "usersBlock", LoadingElementId = "loadingImg" }, new { @id = "userFilterForm" }))
        {
            <a title="Статистика событий авторизации в приложении" class="btn btn-primary" href="~/Administrator/UsersManagement/LoginAudit">Аудит входа</a>
            <a title="Создание новой учетной записи" class="btn btn-primary" href="~/Administrator/UsersManagement/Register">Добавить пользователя</a>
            <div class="input-group pull-right">
                <span class="input-group-addon" id="clearfilter" title="Сброс фильтра"><i class="fa fa-refresh"></i></span>
                @Html.TextBox("fUserName", null,
                new
                {
                    @style = "width:260px;",
                    @type = "text",
                    @class = "form-control",
                    @placeholder = "Пользователь",
                    @title = "ФИО пользователя, логин",
                })
                <span class="input-group-addon" id="applyfilter" title="Применить фильтр"><i class="fa fa-check-circle"></i></span>
            </div>
        }
    </div>

    <div id="usersBlock">
        @Html.Action("ShowUsersPartial", "UsersManagement", new { @fUserName = "" })
    </div>
</div>

<a href="#" class="scrollup1">Наверх</a>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/Scripts/FRScripts/toparrow.js"></script>
    <script>
        $(function () {

            $('#loadingImg').hide();

            $('#clearfilter').on('click', function () {
                $('#fUserName').val("");
                $('#userFilterForm').submit();
            });

            $('body').on('click', '#applyfilter', function (e) {
                $('#userFilterForm').submit();
            });
        });
    </script>
}